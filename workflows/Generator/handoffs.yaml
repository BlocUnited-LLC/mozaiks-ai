handoffs:
  handoff_rules:
    - source_agent: ContextAgent
      target_agent: ToolsAgent
      handoff_type: after_work
      condition: null
      transition_target: AgentTarget

    - source_agent: ToolsAgent
      target_agent: ToolsManagerAgent
      handoff_type: after_work
      condition: null
      transition_target: AgentTarget

    - source_agent: ToolsManagerAgent
      target_agent: AgentsAgent
      handoff_type: after_work
      condition: null
      transition_target: AgentTarget

    - source_agent: AgentsAgent
      target_agent: ContextVariablesAgent
      handoff_type: after_work
      condition: null
      transition_target: AgentTarget

    - source_agent: ContextVariablesAgent
      target_agent: HandoffsAgent
      handoff_type: after_work
      condition: null
      transition_target: AgentTarget

    - source_agent: HandoffsAgent
      target_agent: OrchestratorAgent
      handoff_type: after_work
      condition: null
      transition_target: AgentTarget

    - source_agent: OrchestratorAgent
      target_agent: StructuredOutputsAgent
      handoff_type: after_work
      condition: null
      transition_target: AgentTarget

    - source_agent: StructuredOutputsAgent
      target_agent: APIKeyAgent
      handoff_type: after_work
      condition: null
      transition_target: AgentTarget

    

    - source_agent: APIKeyAgent
      target_agent: user
      handoff_type: after_work
      condition: "If the users request requires API keys for external services, such as OpenAI, Anthropic, Azure OpenAI, Google, Hugging Face, or GitHub."
      transition_target: RevertToUserTarget

    - source_agent: APIKeyAgent
      target_agent: UserFeedbackAgent
      handoff_type: after_work
      condition: "If the users request does not require API keys, or if the API keys have already been collected."
      transition_target: AgentTarget

    - source_agent: UserFeedbackAgent
      target_agent: user
      handoff_type: after_work
      condition: null
      transition_target: RevertToUserTarget

    - source_agent: user
      target_agent: terminate
      handoff_type: condition
      condition: "When the user explicitly accepts the final generated workflow files AND expresses satisfaction with the complete workflow generation process. Only terminate if the user has received downloadable files and confirms completion with specific acceptance phrases like 'I accept these files', 'download complete workflow', 'this workflow is perfect', or 'I'm satisfied with the generated workflow'."
      transition_target: TerminateTarget

    - source_agent: user
      target_agent: ContextAgent
      handoff_type: condition
      condition: "When the user wants to restart the workflow generation, modify requirements, or start over with a different approach. This includes requests to change the workflow design or requirements."
      transition_target: AgentTarget
