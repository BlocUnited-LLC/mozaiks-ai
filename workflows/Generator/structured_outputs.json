{
  "structured_outputs": {
    "models": {
      "AgentSpec": {
        "type": "model",
        "fields": {
          "agent_title": {
            "type": "str",
            "description": "Short name of the agent"
          },
          "agent_type": {
            "type": "str",
            "enum": [
              "ContextualAgent",
              "FunctionalAgent",
              "ThirdPartyAgent",
              "InterviewAgent",
              "UIToolsAgent"
            ],
            "description": "Defines whether the agent is contextual only, requires tools, external APIs, interviewer, or UI stubs."
          },
          "agent_description": {
            "type": "str",
            "description": "Explicit role and behavior of the agent. Must explain how listed services are used (or clarify none are needed)."
          },
          "services": {
            "type": "list",
            "items": "str",
            "description": "List of external services required. Leave empty if none. Services must be proper case (e.g., 'Slack', 'Google Sheets'). Do NOT include payments or alternative LLMs/frameworks."
          }
        }
      },
      "ModuleSpec": {
        "type": "model",
        "fields": {
          "module_title": {
            "type": "str",
            "description": "Concise name of the module"
          },
          "module_description": {
            "type": "str",
            "description": "Plain-language purpose of the module"
          },
          "human_in_the_loop": {
            "type": "bool",
            "description": "Whether this module requires human input or approval (true/false)."
          },
          "agents": {
            "type": "list",
            "items": "AgentSpec",
            "description": "Agents contained in this module."
          }
        }
      },
      "ActionPlan": {
        "type": "model",
        "fields": {
          "workflow_title": {
            "type": "str",
            "description": "Concise workflow title"
          },
          "workflow_description": {
            "type": "str",
            "description": "Short description of purpose and value"
          },
          "mermaid_flow": {
            "type": "str",
            "description": "Mermaid flowchart diagram; MUST start with 'flowchart LR' and map modules \u00e2\u2020\u2019 agents \u00e2\u2020\u2019 services."
          },
          "modules": {
            "type": "list",
            "items": "ModuleSpec",
            "description": "List of modules, each containing agents, services, and human-in-the-loop indicator."
          },
          "constraints": {
            "type": "list",
            "items": "str",
            "description": "Explicit rules, preferences, or limitations for the automation process. Can be empty."
          }
        }
      },
      "ContextAgentOutput": {
        "type": "model",
        "fields": {
          "ActionPlan": {
            "type": "ActionPlan",
            "description": "The Action Plan object (required)."
          },
          "agent_message": {
            "type": "str",
            "description": "Message prompting the user to review the Action Plan."
          }
        }
      },
      "APIKeyRequest": {
        "type": "model",
        "fields": {
          "service": {
            "type": "str",
            "description": "Lowercase identifier of the service requiring an API key (e.g., 'slack', 'google_sheets')."
          },
          "description": {
            "type": "str",
            "description": "Purpose of this API key, derived from the agent_description in the Action Plan."
          },
          "mask_input": {
            "type": "bool",
            "description": "Always true to hide sensitive input."
          },
          "agent_message": {
            "type": "str",
            "description": "Message prompting the user to provide API Key."
          }
        }
      },
      "DatabaseRef": {
        "type": "model",
        "fields": {
          "database_name": {
            "type": "str",
            "description": "Name of the target database"
          },
          "collection": {
            "type": "str",
            "description": "Collection name where the variable resides"
          },
          "search_by": {
            "type": "str",
            "description": "Field used as the query key when accessing this variable"
          },
          "field": {
            "type": "str",
            "description": "Specific field in the collection that stores the variable"
          }
        }
      },
      "DatabaseVariable": {
        "type": "model",
        "fields": {
          "name": { "type": "str", "description": "Database variable name" },
          "description": { "type": "str", "description": "Purpose / usage in workflow" },
          "type": { "type": "optional_str", "description": "Optional type hint for downstream consumers (e.g., string|boolean)" },
          "database": { "type": "DatabaseRef", "description": "Database reference information" }
        }
      },
      "EnvironmentVariable": {
        "type": "model",
        "fields": {
          "name": { "type": "str", "description": "Environment variable name" },
          "description": { "type": "str", "description": "Purpose / usage in workflow" },
          "type": { "type": "optional_str", "description": "Optional type hint (boolean|integer|string)" },
          "env_var": { "type": "str", "description": "Underlying environment variable key" },
          "default": {
            "type": "union",
            "variants": [ "null", "str", "bool", "int" ],
            "description": "Fallback value when the environment variable is not set"
          }
        }
      },
      "DeclarativeVariable": {
        "type": "model",
        "fields": {
          "name": { "type": "str", "description": "Declarative variable name" },
          "description": { "type": "str", "description": "Purpose / usage in workflow" },
          "type": { "type": "optional_str", "description": "Optional type hint (string|boolean|integer|dict)" },
          "value": {
            "type": "union",
            "variants": [ "str", "bool", "int", "float", "dict" ],
            "description": "Literal value injected into context"
          }
        }
      },
      "DerivedVariable": {
        "type": "model",
        "fields": {
          "name": {
            "type": "str",
            "description": "Derived variable name (computed, not persisted)"
          },
          "trigger_type": {
            "type": "literal",
            "values": [
              "agent_text_equals"
            ],
            "description": "Type of deterministic trigger rule"
          },
          "source_agent": {
            "type": "str",
            "description": "Agent whose output activates this derived variable"
          },
          "trigger_value": {
            "type": "str",
            "description": "Exact value required to satisfy trigger (e.g., NEXT)"
          },
          "description": {
            "type": "str",
            "description": "Purpose / effect of the derived variable when true"
          }
        }
      },
      "ContextVariablesPlan": {
        "type": "model",
        "fields": {
          "database_variables": {
            "type": "list",
            "items": "DatabaseVariable",
            "description": "Variables loaded from a database source"
          },
          "environment_variables": {
            "type": "list",
            "items": "EnvironmentVariable",
            "description": "Variables sourced from environment flags"
          },
          "declarative_variables": {
            "type": "list",
            "items": "DeclarativeVariable",
            "description": "Static values declared directly in the workflow context"
          },
          "derived_variables": {
            "type": "list",
            "items": "DerivedVariable",
            "description": "Deterministic, computed state flags triggered by agent outputs (e.g., interview_complete on NEXT)"
          }
        }
      },
      "ContextVariablesAgentOutput": {
        "type": "model",
        "fields": {
          "ContextVariablesPlan": {
            "type": "ContextVariablesPlan",
            "description": "Complete plan of context variables (database_variables, environment_variables, declarative_variables, derived_variables)."
          }
        }
      },
      "UIConfig": {
        "type": "model",
        "fields": {
          "component": {
            "type": "optional_str",
            "description": "React component name (UI_Tool only)"
          },
          "mode": {
            "type": "optional_str",
            "description": "inline or artifact (UI_Tool only)"
          }
        }
      },
      "ToolSpec": {
        "type": "model",
        "fields": {
          "agent": {
            "type": "str",
            "description": "Owning agent (or primary agent)"
          },
          "file": {
            "type": "str",
            "description": "Python module file name"
          },
          "function": {
            "type": "str",
            "description": "Async function inside the file"
          },
          "tool_type": {
            "type": "literal",
            "values": [
              "UI_Tool",
              "Agent_Tool"
            ],
            "description": "Tool type"
          },
          "ui": {
            "type": "UIConfig",
            "description": "UI metadata (nulls for Agent_Tool)"
          }
        }
      },
      "ToolsManagerAgentOutput": {
        "type": "model",
        "fields": {
          "tools": {
            "type": "list",
            "items": "ToolSpec",
            "description": "List of tool entries (mirrors tools.json format)"
          }
        }
      },
      "UIFile": {
        "type": "model",
        "fields": {
          "tool_name": {
            "type": "str",
            "description": "snake_case tool id (must match ToolsAgent manifest)"
          },
          "py_content": {
            "type": "str",
            "description": "Complete Python async stub source for the UI tool"
          },
          "js_content": {
            "type": "str",
            "description": "Complete React component stub source for the UI tool"
          }
        }
      },
      "UIFileGeneratorOutput": {
        "type": "model",
        "fields": {
          "tools": {
            "type": "list",
            "items": "UIFile",
            "description": "List of UI tools, each with Python + JS source (paths inferred downstream)"
          }
        }
      },
      "AgentTool": {
        "type": "model",
        "fields": {
          "tool_name": {
            "type": "str",
            "description": "snake_case tool id (maps to a backend/compute tool)"
          },
          "py_content": {
            "type": "str",
            "description": "Complete Python module source for this tool"
          }
        }
      },
      "AgentToolsFileGeneratorOutput": {
        "type": "model",
        "fields": {
          "tools": {
            "type": "list",
            "items": "AgentTool",
            "description": "List of backend tools, each with its Python source (path inferred downstream)"
          }
        }
      },
      "Hook": {
        "type": "model",
        "fields": {
          "hook_type": {
            "type": "literal",
            "values": [
              "process_message_before_send",
              "update_agent_state",
              "process_last_received_message",
              "process_all_messages_before_reply"
            ],
            "description": "Lifecycle hook type"
          },
          "hook_agent": {
            "type": "str",
            "description": "PascalCase agent name to attach hook to"
          },
          "filename": {
            "type": "str",
            "description": "File path (tools/<hook_type>.py)"
          },
          "function": {
            "type": "str",
            "description": "Function name that implements the hook"
          },
          "filecontent": {
            "type": "str",
            "description": "Hook implementation source code that includes the function defined above"
          }
        }
      },
      "HookAgentOutput": {
        "type": "model",
        "fields": {
          "hooks": {
            "type": "list",
            "items": "Hook",
            "description": "List of lifecycle hooks"
          }
        }
      },
      "AgentDefinition": {
        "type": "model",
        "fields": {
          "name": {
            "type": "str",
            "description": "Agent variable name"
          },
          "display_name": {
            "type": "str",
            "description": "Agent display name"
          },
          "system_message": {
            "type": "str",
            "description": "Complete system message for the agent"
          },
          "max_consecutive_auto_reply": {
            "type": "int",
            "default": 10
          },
          "structured_outputs": {
            "type": "bool",
            "default": false,
            "description": "Whether this agent produces structured outputs"
          },
          "structured_outputs_required": {
            "type": "bool",
            "description": "True when the agent must produce structured outputs (Pydantic model enforced); false otherwise."
          }
        }
      },
      "AgentsAgentOutput": {
        "type": "model",
        "fields": {
          "agents": {
            "type": "list",
            "items": "AgentDefinition"
          }
        }
      },
      "OrchestratorAgentOutput": {
        "type": "model",
        "fields": {
          "workflow_name": {
            "type": "str",
            "description": "Workflow identifier"
          },
          "max_turns": {
            "type": "int",
            "description": "Maximum conversation turns"
          },
          "human_in_the_loop": {
            "type": "bool",
            "description": "Whether human interaction is required"
          },
          "startup_mode": {
            "type": "literal",
            "values": [
              "AgentDriven",
              "UserDriven",
              "BackendOnly"
            ]
          },
          "orchestration_pattern": {
            "type": "str",
            "default": "DefaultPattern"
          },
          "initial_message_to_user": {
            "type": "optional_str",
            "description": "Message shown to user (UserDriven only)"
          },
          "initial_message": {
            "type": "optional_str",
            "description": "Initial workflow message (AgentDriven/BackendOnly)"
          },
          "recipient": {
            "type": "str",
            "description": "First agent to receive message"
          },
          "visual_agents": {
            "type": "list",
            "items": "str",
            "description": "Agents whose messages are visible in UI"
          },
          "visual_agent": {
            "type": "list",
            "items": "str",
            "description": "Agents that can emit UI tool events"
          }
        }
      },
      "HandoffRule": {
        "type": "model",
        "fields": {
          "source_agent": {
            "type": "str",
            "description": "Source agent name"
          },
          "target_agent": {
            "type": "str",
            "description": "Target agent name or 'user' or 'terminate'"
          },
          "handoff_type": {
            "type": "literal",
            "values": [
              "condition",
              "after_work"
            ],
            "description": "Type of handoff"
          },
          "condition": {
            "type": "optional_str",
            "description": "Condition for conditional handoffs"
          },
          "condition_type": {
            "type": "literal",
            "values": [
              "expression",
              "string_llm"
            ],
            "description": "Optional override: use 'expression' for context expressions or omit to fall back to LLM evaluation. Use null in registry to indicate omitted."
          },
          "transition_target": {
            "type": "literal",
            "values": [
              "AgentTarget",
              "RevertToUserTarget",
              "TerminateTarget"
            ],
            "description": "Type of transition"
          }
        }
      },
      "HandoffsAgentOutput": {
        "type": "model",
        "fields": {
          "handoff_rules": {
            "type": "list",
            "items": "HandoffRule"
          }
        }
      },
      "StructuredModelField": {
        "type": "model",
        "fields": {
          "name": {
            "type": "str",
            "description": "Field name"
          },
          "type": {
            "type": "str",
            "description": "Field type (str|int|bool|list|optional_str)"
          },
          "description": {
            "type": "str",
            "description": "What this field represents"
          }
        }
      },
      "StructuredModelDefinition": {
        "type": "model",
        "fields": {
          "model_name": {
            "type": "str",
            "description": "Name of the model"
          },
          "fields": {
            "type": "list",
            "items": "StructuredModelField"
          }
        }
      },
      "AgentRegistryEntry": {
        "type": "model",
        "fields": {
          "agent": {
            "type": "str",
            "description": "Agent name"
          },
          "agent_definition": {
            "type": "optional_str",
            "description": "Model name for this agent, or null if no structured output applies"
          }
        }
      },
      "StructuredOutputsAgentOutput": {
        "type": "model",
        "fields": {
          "models": {
            "type": "list",
            "items": "StructuredModelDefinition",
            "description": "Data models to capture"
          },
          "registry": {
            "type": "list",
            "items": "AgentRegistryEntry"
          }
        }
      }
    }
  },
  "registry": {
    "InterviewAgent": null,
    "ContextAgent": "ContextAgentOutput",
    "ToolsManagerAgent": "ToolsManagerAgentOutput",
    "UIFileGenerator": "UIFileGeneratorOutput",
    "AgentToolsFileGenerator": "AgentToolsFileGeneratorOutput",
    "HookAgent": "HookAgentOutput",
    "AgentsAgent": "AgentsAgentOutput",
    "ContextVariablesAgent": "ContextVariablesAgentOutput",
    "OrchestratorAgent": "OrchestratorAgentOutput",
    "HandoffsAgent": "HandoffsAgentOutput",
    "StructuredOutputsAgent": "StructuredOutputsAgentOutput",
    "APIKeyAgent": null,
    "UserFeedbackAgent": null
  }
}
