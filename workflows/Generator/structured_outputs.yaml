structured_outputs:
  models:
    AgentDefinition:
      type: model
      fields:
        name:
          type: str
          description: "Agent variable name"
        display_name:
          type: str
          description: "Agent display name"
        system_message:
          type: str
          description: "Complete system message for the agent"
        human_input_mode:
          type: literal
          values: ["ALWAYS", "NEVER", "TERMINATE"]
        max_consecutive_auto_reply:
          type: int
          default: 10

    AgentsOutput:
      type: model
      fields:
        agents:
          type: list
          items: AgentDefinition

    ContextVariablesDefinition:
      type: model
      fields:
        name:
          type: str
          description: "Variable name"
        extraction_code:
          type: str
          description: "Python code to extract value (e.g., \"concept_data.get('ProjectTitle', '')\")"
        description:
          type: str
          description: "Description of what this variable represents"
        default_value:
          type: str
          description: "Default value if extraction fails"
          default: "''"

    ContextVariablesOutput:
      type: model
      fields:
        context_variables:
          type: list
          items: ContextVariablesDefinition

    HandoffRule:
      type: model
      fields:
        source_agent:
          type: str
          description: "Source agent name"
        target_agent:
          type: str
          description: "Target agent name or 'user' for user handoff"
        handoff_type:
          type: literal
          values: ["llm_condition", "after_work"]
          description: "Type of handoff condition"
        condition:
          type: optional_str
          default: null
          description: "LLM condition prompt if handoff_type is llm_condition"
        description:
          type: str
          description: "Human-readable description of the handoff rule"

    HandoffsOutput:
      type: model
      fields:
        handoff_rules:
          type: list
          items: HandoffRule

    OrchestratorOutput:
      type: model
      fields:
        workflow_name:
          type: str
          description: "Name of the workflow"
        max_turns:
          type: int
          default: 25
          description: "Maximum workflow turns"
        human_in_the_loop:
          type: bool
          description: "Whether human interaction is required in the workflow"
        startup_mode:
          type: literal
          values: ["AgentDriven", "UserDriven", "BackendOnly"]
          description: "How the workflow interface behaves"
        orchestration_pattern:
          type: str
          description: "Orchestration pattern (DefaultPattern, AutoPattern, etc.)"
        initial_message_to_user:
          type: optional_str
          default: null
          description: "Message shown to user (null for AgentDriven/BackendOnly)"
        initial_message:
          type: optional_str
          default: null
          description: "Initial workflow message (null for UserDriven)"

    StructuredModelField:
      # Hints for authors (not enforced by schema):
      agent: "Agent's name this structured output supports"
      agent_defnition: "Definition/model name for that agent"
      type: model
      fields:
        name:
          type: str
          description: "Field name"
        type:
          type: str
          description: "Type (e.g., str, int, bool, list, optional_str)"
        description:
          type: str
          description: "Brief description of what this field represents"

    StructuredModelDefinition:
      type: model
      fields:
        model_name:
          type: str
          description: "Model/definition name"
        fields:
          type: list
          items: StructuredModelField

    StructuredAgentOutputs:
      type: model
      fields:
        models:
          type: list
          items: StructuredModelDefinition
        registry:
          type: list
          items:
            type: model
            fields:
              agent:
                type: str
                description: "Agent's name the model is for"
              agent_defnition:
                type: str
                description: "Definition/model name linked to that agent"

    FileSpec:
      type: model
      fields:
        filename:
          type: str
          description: "Relative filename to create inside the workflow folder"
        filecontent:
          type: str
          description: "Complete file contents to write"
        language:
          type: optional_str
          default: null
          description: "Optional hint for code type (e.g., 'python' for .py, 'javascript' for .js)"
        purpose:
          type: optional_str
          default: null
          description: "Optional short purpose of this file"

    ToolsAgentOutput:
      type: model
      fields:
        files:
          type: list
          items: FileSpec
        visual_agents:
          type: list
          items: str

    ToolsManagerAgentOutput:
      type: model
      fields:
        tools_config:
          type: str
          description: "JSON string containing tools configuration (ui_tools, lifecycle_tools, backend_tools)"
        ui_config:
          type: str
          description: "JSON string containing UI config (visual_agents, ui_capable_agents)"

# Registry for structured outputs

  registry:
    ContextVariablesAgent: ContextVariablesOutput
    AgentsAgent: AgentsOutput
    HandoffsAgent: HandoffsOutput
    OrchestratorAgent: OrchestratorOutput
    StructuredOutputsAgent: StructuredAgentOutputs
    ToolsAgent: ToolsAgentOutput
    ToolsManagerAgent: ToolsManagerAgentOutput
