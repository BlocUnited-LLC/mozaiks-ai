{
  "definitions": [
    {
      "name": "context_aware",
      "type": "boolean",
      "description": "Flag indicating if the application is opensource (in which the llm will ask for context) or part of an existing product in which the agent will be seeded with initial context",
      "source": {
        "type": "config",
        "env_var": "CONTEXT_AWARE",
        "default": true
      }
    },
    {
      "name": "concept_overview",
      "type": "string",
      "description": "Main project description and overview from the database",
      "source": {
        "type": "data_reference",
        "db_type": "mongodb",
        "database_name": "autogen_ai_agents",
        "collection": "Concepts",
        "query_template": {
          "enterprise_id": "{{runtime.enterprise_id}}"
        },
        "fields": [
          "ConceptOverview"
        ]
      }
    },
    {
      "name": "monetization_enabled",
      "type": "boolean",
      "description": "Flag indicating if monetization features are enabled",
      "source": {
        "type": "config",
        "env_var": "MONETIZATION_ENABLED",
        "default": false
      }
    },
    {
      "name": "context_include_schema",
      "type": "boolean",
      "description": "Flag indicating if database schema access is enabled for this workflow",
      "source": {
        "type": "config",
        "env_var": "CONTEXT_INCLUDE_SCHEMA",
        "default": false
      }
    },
    {
      "name": "context_schema_db",
      "type": "string",
      "description": "Name of the database this workflow has schema access to",
      "source": {
        "type": "config",
        "env_var": "CONTEXT_SCHEMA_DB",
        "default": null
      }
    },
    {
      "name": "interview_complete",
      "type": "boolean",
      "description": "True once InterviewAgent has enough context to proceed to the next stage",
      "source": {
        "type": "state",
        "default": false,
        "transitions": [
          {
            "to": true,
            "trigger": {
              "type": "agent_text",
              "agent": "InterviewAgent",
              "ui_hidden": true,
              "match": {
                "equals": "NEXT"
              }
            }
          }
        ]
      }
    },
    {
      "name": "action_plan_acceptance",
      "type": "string",
      "description": "User's response to the action plan: 'accepted', 'adjustments_requested', or 'pending'. Updated after the combined Action Plan + diagram review UI completes.",
      "source": {
        "type": "state",
        "default": "pending",
        "transitions": [
          {
            "trigger": {
              "type": "ui_response",
              "tool": "mermaid_sequence_diagram",
              "response_key": "plan_acceptance"
            }
          }
        ]
      }
    },
    {
      "name": "action_plan",
      "type": "object",
      "description": "The complete module-based Action Plan workflow object generated by WorkflowImplementationAgent. Used for revision handling and downstream UI updates.",
      "source": {
        "type": "computed",
        "default": null
      }
    },
    {
      "name": "workflow_strategy",
      "type": "object",
      "description": "High-level workflow strategy (modules) generated by WorkflowStrategyAgent for downstream implementation.",
      "source": {
        "type": "computed",
        "default": null
      }
    },
    {
      "name": "technical_blueprint",
      "type": "object",
      "description": "Workflow-wide technical blueprint detailing shared context variables, UI Components, and lifecycle hooks authored by WorkflowArchitectAgent.",
      "source": {
        "type": "computed",
        "default": null
      }
    },
    {
      "name": "strategy_ready",
      "type": "boolean",
      "description": "True when WorkflowStrategyAgent has stored the high-level plan for downstream agents.",
      "source": {
        "type": "state",
        "default": false,
        "transitions": []
      }
    },
    {
      "name": "download_complete",
      "type": "boolean",
      "description": "True when user accepts workflow download and completes the session. Triggers workflow termination.",
      "source": {
        "type": "state",
        "default": false,
        "transitions": [
          {
            "to": true,
            "trigger": {
              "type": "ui_response",
              "tool": "generate_and_download",
              "response_key": "download_accepted"
            }
          }
        ]
      }
    },
    {
      "name": "is_multi_workflow",
      "type": "boolean",
      "description": "True if PatternAgent determined the solution requires multiple workflows (a workflow pack). Set by PatternAgent based on complexity heuristics. Drives iterative pack generation.",
      "source": {
        "type": "computed",
        "default": false
      }
    },
    {
      "name": "pack_name",
      "type": "string",
      "description": "Name of the workflow pack (e.g., 'ecommerce-pack'). Set by PatternAgent. Used for _pack/ metadata generation and folder naming.",
      "source": {
        "type": "computed",
        "default": null
      }
    },
    {
      "name": "current_workflow_index",
      "type": "integer",
      "description": "Zero-based index of the workflow currently being generated within a multi-workflow pack. Updated by runtime iteration loop. Allows WorkflowStrategyAgent and downstream agents to know which workflow they are building.",
      "source": {
        "type": "state",
        "default": 0
      }
    },
    {
      "name": "workflows_spec",
      "type": "array",
      "description": "Array of workflow specs from PatternAgent's PatternSelection output. Each item contains: name, role, pattern_type, description. Drives pack iteration.",
      "source": {
        "type": "computed",
        "default": []
      }
    },
    {
      "name": "generated_workflows",
      "type": "array",
      "description": "Array of completed workflow outputs accumulated during pack generation. Each entry contains the full workflow JSON for one workflow. Used by PackMetadataAgent to derive cross-workflow state.",
      "source": {
        "type": "state",
        "default": []
      }
    },
    {
      "name": "pack_generation_complete",
      "type": "boolean",
      "description": "True when all workflows in a multi-workflow pack have been generated. Set by pack_loop_check lifecycle tool. Used by handoffs to decide: loop back to WorkflowStrategyAgent (false) or proceed to PackMetadataAgent (true).",
      "source": {
        "type": "state",
        "default": false
      }
    }
  ],
  "agents": [
    {
      "agent_name": "InterviewAgent",
      "variables": [
        "context_aware",
        "concept_overview",
        "monetization_enabled"
      ]
    },
    {
      "agent_name": "PatternAgent",
      "variables": [
        "concept_overview",
        "monetization_enabled",
        "is_multi_workflow",
        "pack_name",
        "workflows_spec"
      ]
    },
    {
      "agent_name": "ProjectOverviewAgent",
      "variables": [
        "concept_overview",
        "action_plan"
      ]
    },
    {
      "agent_name": "DownloadAgent",
      "variables": [
        "action_plan",
        "is_multi_workflow",
        "pack_name",
        "workflows_spec",
        "generated_workflows"
      ]
    },
    {
      "agent_name": "WorkflowStrategyAgent",
      "variables": [
        "concept_overview",
        "interview_complete",
        "workflow_strategy",
        "strategy_ready",
        "is_multi_workflow",
        "workflows_spec",
        "current_workflow_index"
      ]
    },
    {
      "agent_name": "PackMetadataAgent",
      "variables": [
        "is_multi_workflow",
        "pack_name",
        "workflows_spec",
        "generated_workflows"
      ]
    },
    {
      "agent_name": "WorkflowArchitectAgent",
      "variables": [
        "concept_overview",
        "monetization_enabled",
        "workflow_strategy",
        "action_plan",
        "context_include_schema",
        "context_schema_db",
        "database_schema_available",
        "database_schema_db",
        "schema_overview",
        "collections_first_docs_full"
      ]
    },
    {
      "agent_name": "WorkflowImplementationAgent",
      "variables": [
        "concept_overview",
        "workflow_strategy",
        "action_plan",
        "strategy_ready",
        "action_plan_acceptance"
      ]
    }
  ]
}