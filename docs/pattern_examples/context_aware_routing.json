{
  "workflow_name": "Context-Aware Support Router",
  "pattern_id": 1,
  "pattern_name": "Context-Aware Routing",
  "trigger": "chat",
  "initiated_by": "user",
  "human_in_loop": true,
  "modules": [
    {
      "module_index": 0,
      "module_name": "Domain Routing and Resolution",
      "module_description": "Classify incoming requests and route them to the right specialist with a lightweight confirmation step.",
      "pattern_id": 1,
      "pattern_name": "Context-Aware Routing",
      "context_variables": [
        {
          "name": "current_domain",
          "type": "state",
          "description": "Current domain classification used for routing."
        },
        {
          "name": "routing_confidence",
          "type": "state",
          "description": "Confidence score for the domain decision."
        },
        {
          "name": "resolution_status",
          "type": "state",
          "description": "Tracks if the specialist completed the request."
        }
      ],
      "agents": [
        {
          "agent_name": "RouterAgent",
          "agent_type": "router",
          "objective": "Owns intake, classifies the request, confirms routing choice, and hands off to the right specialist.",
          "generation_mode": null,
          "agent_tools": [
            {
              "name": "classify_intent",
              "integration": "OpenAI",
              "purpose": "Detect domain and intent from the latest user message.",
              "interaction_mode": "none"
            },
            {
              "name": "confirm_route",
              "integration": null,
              "purpose": "Inline confirmation so the user can validate the chosen domain before routing.",
              "interaction_mode": "inline"
            }
          ],
          "lifecycle_tools": [],
          "system_hooks": [],
          "human_interaction": "context",
          "max_consecutive_auto_reply": 20
        },
        {
          "agent_name": "TechSpecialist",
          "agent_type": "worker",
          "objective": "Handles technology and product questions end-to-end with suggested fixes and docs links.",
          "generation_mode": null,
          "agent_tools": [
            {
              "name": "resolve_tech_issue",
              "integration": "OpenAI",
              "purpose": "Generate and validate a technical response.",
              "interaction_mode": "none"
            }
          ],
          "lifecycle_tools": [],
          "system_hooks": [],
          "human_interaction": "none",
          "max_consecutive_auto_reply": 30
        },
        {
          "agent_name": "FinanceSpecialist",
          "agent_type": "worker",
          "objective": "Resolves billing and account questions with policy-aware answers and safe refunds guidance.",
          "generation_mode": null,
          "agent_tools": [
            {
              "name": "resolve_finance_issue",
              "integration": "OpenAI",
              "purpose": "Produce billing/account resolution steps.",
              "interaction_mode": "none"
            }
          ],
          "lifecycle_tools": [],
          "system_hooks": [],
          "human_interaction": "none",
          "max_consecutive_auto_reply": 30
        },
        {
          "agent_name": "GeneralSpecialist",
          "agent_type": "worker",
          "objective": "Covers general inquiries and acts as the fallback when domain confidence is low.",
          "generation_mode": null,
          "agent_tools": [
            {
              "name": "resolve_general_issue",
              "integration": "OpenAI",
              "purpose": "Draft a clear, concise response and ask for missing details.",
              "interaction_mode": "none"
            }
          ],
          "lifecycle_tools": [],
          "system_hooks": [],
          "human_interaction": "none",
          "max_consecutive_auto_reply": 30
        }
      ],
      "handoffs": [
        {
          "from": "RouterAgent",
          "to": "TechSpecialist",
          "condition": "current_domain == 'technology'",
          "type": "OnContextCondition"
        },
        {
          "from": "RouterAgent",
          "to": "FinanceSpecialist",
          "condition": "current_domain == 'finance'",
          "type": "OnContextCondition"
        },
        {
          "from": "RouterAgent",
          "to": "GeneralSpecialist",
          "condition": "current_domain in ['general', 'other']",
          "type": "OnContextCondition"
        }
      ],
      "tools": [
        {
          "agent": "RouterAgent",
          "function": "classify_intent",
          "file": "classify_intent.py",
          "description": "Detect domain and route using DefaultPattern conditions.",
          "tool_type": "Agent_Tool",
          "auto_invoke": false,
          "ui": null,
          "integration": "OpenAI"
        },
        {
          "agent": "RouterAgent",
          "function": "confirm_route",
          "file": "confirm_route.py",
          "description": "Inline confirmation of the routing decision.",
          "tool_type": "UI_Tool",
          "auto_invoke": true,
          "ui": {
            "component": "ConfirmationCard",
            "mode": "inline",
            "ui_pattern": "single_step"
          },
          "integration": null
        }
      ],
      "hooks": {
        "before_chat": null,
        "after_chat": null,
        "agent_hooks": []
      },
      "orchestrator": {
        "type": "DefaultPattern",
        "config": {
          "start_agent": "RouterAgent"
        }
      }
    }
  ]
}
