{
  "workflow_name": "Order Fulfillment Pipeline",
  "pattern_id": 6,
  "pattern_name": "Pipeline",
  "trigger": "form_submit",
  "initiated_by": "user",
  "human_in_loop": true,
  "modules": [
    {
      "module_index": 0,
      "module_name": "Linear Processing",
      "module_description": "Validate, process, and deliver an order in a strict sequence.",
      "pattern_id": 6,
      "pattern_name": "Pipeline",
      "context_variables": [
        {
          "name": "current_stage",
          "type": "state",
          "description": "Stage marker: intake, validation, payment, fulfillment, notification."
        },
        {
          "name": "has_error",
          "type": "state",
          "description": "Flags if the pipeline must pause or revert to the user."
        },
        {
          "name": "order_payload",
          "type": "data_entity",
          "description": "Normalized order payload captured from the form."
        }
      ],
      "agents": [
        {
          "agent_name": "IntakeAgent",
          "agent_type": "intake",
          "objective": "Receives the order form payload, normalizes it, and kicks off validation.",
          "generation_mode": null,
          "agent_tools": [
            {
              "name": "capture_order",
              "integration": null,
              "purpose": "Inline confirmation of submitted order details.",
              "interaction_mode": "inline"
            }
          ],
          "lifecycle_tools": [],
          "system_hooks": [],
          "human_interaction": "context",
          "max_consecutive_auto_reply": 20
        },
        {
          "agent_name": "ValidationAgent",
          "agent_type": "worker",
          "objective": "Validates required fields, inventory, and policy compliance.",
          "generation_mode": null,
          "agent_tools": [
            {
              "name": "run_validation_checks",
              "integration": "OpenAI",
              "purpose": "Validate data and surface blockers.",
              "interaction_mode": "none"
            }
          ],
          "lifecycle_tools": [],
          "system_hooks": [],
          "human_interaction": "none",
          "max_consecutive_auto_reply": 30
        },
        {
          "agent_name": "PaymentAgent",
          "agent_type": "worker",
          "objective": "Processes payment and records transaction status.",
          "generation_mode": null,
          "agent_tools": [
            {
              "name": "capture_payment_confirmation",
              "integration": null,
              "purpose": "Artifact approval for payment capture.",
              "interaction_mode": "artifact"
            }
          ],
          "lifecycle_tools": [],
          "system_hooks": [],
          "human_interaction": "approval",
          "max_consecutive_auto_reply": 5
        },
        {
          "agent_name": "FulfillmentAgent",
          "agent_type": "worker",
          "objective": "Creates shipment instructions and updates logistics systems.",
          "generation_mode": null,
          "agent_tools": [
            {
              "name": "prepare_fulfillment",
              "integration": "OpenAI",
              "purpose": "Generate packing and shipment notes.",
              "interaction_mode": "none"
            }
          ],
          "lifecycle_tools": [],
          "system_hooks": [],
          "human_interaction": "none",
          "max_consecutive_auto_reply": 30
        },
        {
          "agent_name": "NotificationAgent",
          "agent_type": "worker",
          "objective": "Sends confirmation to the customer and marks the pipeline complete.",
          "generation_mode": null,
          "agent_tools": [
            {
              "name": "send_confirmation",
              "integration": "SendGrid",
              "purpose": "Dispatch confirmation email with tracking details.",
              "interaction_mode": "none"
            }
          ],
          "lifecycle_tools": [],
          "system_hooks": [],
          "human_interaction": "none",
          "max_consecutive_auto_reply": 30
        }
      ],
      "handoffs": [
        {
          "from": "IntakeAgent",
          "to": "ValidationAgent",
          "condition": "current_stage == 'validation'",
          "type": "OnContextCondition"
        },
        {
          "from": "ValidationAgent",
          "to": "PaymentAgent",
          "condition": "has_error == False and current_stage == 'payment'",
          "type": "OnContextCondition"
        },
        {
          "from": "PaymentAgent",
          "to": "FulfillmentAgent",
          "condition": "has_error == False and current_stage == 'fulfillment'",
          "type": "OnContextCondition"
        },
        {
          "from": "FulfillmentAgent",
          "to": "NotificationAgent",
          "condition": "current_stage == 'notification'",
          "type": "OnContextCondition"
        }
      ],
      "tools": [
        {
          "agent": "IntakeAgent",
          "function": "capture_order",
          "file": "capture_order.py",
          "description": "Confirm submitted order payload inline.",
          "tool_type": "UI_Tool",
          "auto_invoke": true,
          "ui": {
            "component": "OrderReviewForm",
            "mode": "inline",
            "ui_pattern": "two_step_confirmation"
          },
          "integration": null
        },
        {
          "agent": "PaymentAgent",
          "function": "capture_payment_confirmation",
          "file": "capture_payment_confirmation.py",
          "description": "Approval card for payment capture.",
          "tool_type": "UI_Tool",
          "auto_invoke": true,
          "ui": {
            "component": "PaymentApprovalCard",
            "mode": "artifact",
            "ui_pattern": "two_step_confirmation"
          },
          "integration": null
        }
      ],
      "hooks": {
        "before_chat": null,
        "after_chat": null,
        "agent_hooks": []
      },
      "orchestrator": {
        "type": "DefaultPattern",
        "config": {
          "start_agent": "IntakeAgent"
        }
      }
    }
  ]
}
